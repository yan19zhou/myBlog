## 1、浏览器操作

### 1、加载js || css || 风格

- 

```javascript
const loadRes = function (name, type, fn) {
  // 加载js || css || style
  let ref;
  if (type === "js") {
    // 外部js
    ref = document.createElement("script");
    ref.setAttribute("type", "text/JavaScript");
    ref.setAttribute("src", name);
  } else if (type === "css") {
    // 外部css
    ref = document.createElement("link");
    ref.setAttribute("rel", "stylesheet");
    ref.setAttribute("type", "text/css");
    ref.setAttribute("href", name);
  } else if (type === "style") {
    // style
    ref = document.createElement("style");
    ref.innerhtml = name;
  }
  if (typeof ref !== "undefined") {
    document.getElementsByTagName("head")[0].appendChild(ref);
    ref.onload = function () {
      // 加载完成执行
      typeof fn === "function" && fn();
    };
  }
};

```

### 2、获取url参数

- 

```javascript
const getUrlParam = function (name) {
  // 获取url参数
  let reg = new RegExp("(^|&?)" + name + "=([^&]*)(&|$)", "i");
  let r = window.location.href.substr(1).match(reg);
  if (r != null) {
    return decodeURI(r[2]);
  }
  return undefined;
};
/*获取网址参数*/ 
getURL(name){  
    var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");   
    var r = window.location.search.substr(1).match(reg);   
    if(r!=null)
        return  r[2]; return null;
}
/*获取全部url参数,并转换成json对象*/
getUrlAllParams (url) { 
    var url = url ? url : window.location.href;  
    var _pa = url.substring(url.indexOf('?') + 1),  
        _arrS = _pa.split('&'),    
        _rs = {};   
    for (var i = 0, _len = _arrS.length; i < _len; i++) { 
        var pos = _arrS[i].indexOf('=');     
        if (pos == -1) {       
            continue;        
        }       
        var name = _arrS[i].substring(0, pos),      
            value = window.decodeURIComponent(_arrS[i].substring(pos + 1));    
        _rs[name] = value;   
    }    
    return _rs;
}
/*删除url指定参数，返回url*/
delParamsUrl(url, name){ 
    var baseUrl = url.split('?')[0] + '?';  
    var query = url.split('?')[1];  
    if (query.indexOf(name)>-1) {  
        var obj = {}      
        var arr = query.split("&");    
        for (var i = 0; i < arr.length; i++) {     
            arr[i] = arr[i].split("=");   
            obj[arr[i][0]] = arr[i][1];    
        };       
        delete obj[name];      
        var url = baseUrl + JSON.stringify(obj).replace(/[\"\{\}]/g,"").replace(/\:/g,"=").replace(/\,/g,"&");   
        return url  
    }else{   
        return url;   
    }
}
```



### **3、浏览器是否支持webP格式图片**

- 

```javascript
const isSupportWebP = function() { 
//判断浏览器是否支持webP格式图片  
return !![].map && document.createElement('canvas').toDataURL('image/webp').indexOf('data:image/webp') == 0;}
```

### **4、url参数转对象**

- 

```javascript
const parseQueryString = function (url) {
  //url参数转对象
  url = !url ? window.location.href : url;
  if (url.indexOf("?") === -1) {
    return {};
  }
  let search =
    url[0] === "?" ? url.substr(1) : url.substring(url.lastIndexOf("?") + 1);
  if (search === "") {
    return {};
  }
  search = search.split("&");
  let query = {};
  for (let i = 0; i < search.length; i++) {
    let pair = search[i].split("=");
    query[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || "");
  }
  return query;
};

```

### **5、对象序列化【对象转url参数】**

- 

```javascript
const stringfyQueryString = function (obj) {
  //对象序列化【对象转url参数】
  if (!obj) return "";
  let pairs = [];
  for (let key in obj) {
    let value = obj[key];
    if (value instanceof Array) {
      for (let i = 0; i < value.length; ++i) {
        pairs.push(
          encodeURIComponent(key + "[" + i + "]") +
            "=" +
            encodeURIComponent(value[i])
        );
      }
      continue;
    }
    pairs.push(encodeURIComponent(key) + "=" + encodeURIComponent(obj[key]));
  }
  return pairs.join("&");
};
```

### 6、浏览器对象：

> window：window对象有innerWidth和innerHeight属性，可以获取浏览器窗口的内部宽度和高度。内部宽高是指除去菜单栏、工具栏、边框等占位元素后，用于显示网页的净宽高。

```javascript
充分利用JavaScript对不存在属性返回undefined的特性，直接用短路运算符||计算：
	var width = window.innerWidth || document.body.clientWidth;

navigator：
navigator对象表示浏览器的信息，最常用的属性包括：
navigator.appName：浏览器名称；
navigator.appVersion：浏览器版本；
navigator.language：浏览器设置的语言；
navigator.platform：操作系统类型；
navigator.userAgent：浏览器设定的User-Agent字符串。

screen
screen对象表示屏幕的信息，常用的属性有：

	screen.width：屏幕宽度，以像素为单位；
	screen.height：屏幕高度，以像素为单位；
	screen.colorDepth：返回颜色位数，如8、16、24。

location：
location对象表示当前页面的URL信息。例如，一个完整的URL：
可以用location.href获取。要获得URL各个部分的值，可以这么写：

location.protocol; // 'http'
location.host; // 'www.example.com'
location.port; // '8080'
location.pathname; // '/path/index.html'
location.search; // '?a=1&b=2'
location.hash; // 'TOP'

要加载一个新页面，可以调用location.assign()。如果要重新加载当前页面，调用location.reload()方法非常方便。

document
document对象表示当前页面。由于HTML在浏览器中以DOM形式表示为树形结构，document对象就是整个DOM树的根节点。
document的title属性是从HTML文档中的<title>xxx</title>读取的，但是可以动态改变：
document.title="666"
JavaScript可以通过document.cookie读取到当前页面的Cookie：
document.cookie; // 'v=123; remember=true; prefer=zh'
```

### 7、**在网页上获取选定的文本**

```javascript
const getSelectedText = () => window.getSelection().toString()
```

### 8、滚动到页面顶部

```javascript
export const scrollToTop = () => {
  const height = document.documentElement.scrollTop || document.body.scrollTop;
  if (height > 0) {
    window.requestAnimationFrame(scrollToTop);
    window.scrollTo(0, height - height / 8);
  }
}
复制代码
```

### 9、滚动到页面底部

```javascript
export const scrollToBottom = () => {
  window.scrollTo(0, document.documentElement.clientHeight);  
}
复制代码
```

### 10、滚动到指定元素区域

```javascript
export const smoothScroll = (element) => {
    document.querySelector(element).scrollIntoView({
        behavior: 'smooth'
    });
};
复制代码
```

### 11、获取可视窗口高度

```javascript
export const getClientHeight = () => {
    let clientHeight = 0;
    if (document.body.clientHeight && document.documentElement.clientHeight) {
        clientHeight = (document.body.clientHeight < document.documentElement.clientHeight) ? document.body.clientHeight : document.documentElement.clientHeight;
    }
    else {
        clientHeight = (document.body.clientHeight > document.documentElement.clientHeight) ? document.body.clientHeight : document.documentElement.clientHeight;
    }
    return clientHeight;
}
复制代码
```

### 12、获取可视窗口宽度

```javascript
export const getPageViewWidth = () => {
    return (document.compatMode == "BackCompat" ? document.body : document.documentElement).clientWidth;
}
复制代码
```

### 13、打开浏览器全屏

```javascript
export const toFullScreen = () => {
    let element = document.body;
    if (element.requestFullscreen) {
      element.requestFullscreen()
    } else if (element.mozRequestFullScreen) {
      element.mozRequestFullScreen()
    } else if (element.msRequestFullscreen) {
      element.msRequestFullscreen()
    } else if (element.webkitRequestFullscreen) {
      element.webkitRequestFullScreen()
    }
}
复制代码
```

### 14、退出浏览器全屏

```javascript
export const exitFullscreen = () => {
    if (document.exitFullscreen) {
      document.exitFullscreen()
    } else if (document.msExitFullscreen) {
      document.msExitFullscreen()
    } else if (document.mozCancelFullScreen) {
      document.mozCancelFullScreen()
    } else if (document.webkitExitFullscreen) {
      document.webkitExitFullscreen()
    }
}
```



## 2、存储

### 1、本地存储

```javascript
/* '			Storage 储存操作			*/
class StorageFn {  
    constructor () {      
        this.ls = window.localStorage;     
        this.ss = window.sessionStorage; 
    }    
    /*-----------------cookie---------------------*/  
    /*设置cookie*/   
    setCookie (name, value, day) {   
        var setting = arguments[0];       
        if (Object.prototype.toString.call(setting).slice(8, -1) === 'Object'){      
            for (var i in setting) {        
                var oDate = new Date();              
                oDate.setDate(oDate.getDate() + day);           
                document.cookie = i + '=' + setting[i] + ';expires=' + oDate;         
            }      
        }else{   
            var oDate = new Date();        
            oDate.setDate(oDate.getDate() + day);      
            document.cookie = name + '=' + value + ';expires=' + oDate;       
        }          
    }       
    /*获取cookie*/   
    getCookie (name) {       
        var arr = document.cookie.split('; ');    
        for (var i = 0; i < arr.length; i++) {        
            var arr2 = arr[i].split('=');         
            if (arr2[0] == name) {           
                return arr2[1];        
            }      
        }        
        return '';   
    }     
    /*删除cookie*/  
    removeCookie (name) {    
        this.setCookie(name, 1, -1);  
    }   
    /*-----------------localStorage---------------------*/   
    /*设置localStorage*/  
    setLocal(key, val) {      
        var setting = arguments[0];        
        if (Object.prototype.toString.call(setting).slice(8, -1) === 'Object'){   
            for(var i in setting){       
                this.ls.setItem(i, JSON.stringify(setting[i]))     
            }      
        }else{    
            this.ls.setItem(key, JSON.stringify(val))      
        }           
    }      
    /*获取localStorage*/  
    getLocal(key) {       
        if (key) return JSON.parse(this.ls.getItem(key))   
        return null;         
    }       
    /*移除localStorage*/   
    removeLocal(key) {       
        this.ls.removeItem(key)    
    }        
    /*移除所有localStorage*/    
    clearLocal() {        
        this.ls.clear()   
    }    
    /*-----------------sessionStorage---------------------*/   
    /*设置sessionStorage*/   
    setSession(key, val) {      
        var setting = arguments[0];      
        if (Object.prototype.toString.call(setting).slice(8, -1) === 'Object'){    
            for(var i in setting){          
                this.ss.setItem(i, JSON.stringify(setting[i]))       
            }    
        }else{     
                this.ss.setItem(key, JSON.stringify(val))     
        }           
    }       
    /*获取sessionStorage*/   
    getSession(key) {    
        if (key) return JSON.parse(this.ss.getItem(key))     
        return null;       
    }       
    /*移除sessionStorage*/   
    removeSession(key) {    
        this.ss.removeItem(key)  
    }       
    /*移除所有sessionStorage*/   
    clearSession() {  
        this.ss.clear()   
    }
}

```

### **2、cookie 操作【设置，获取，删除】**

- 

```javascript
const cookie = {
  // cookie操作【set，get，del】
  set: function (name, value, day) {
    let oDate = new Date();
    oDate.setDate(oDate.getDate() + (day || 30));
    document.cookie = name + "=" + value + ";expires=" + oDate + "; path=/;";
  },
  get: function (name) {
    let str = document.cookie;
    let arr = str.split("; ");
    for (let i = 0; i < arr.length; i++) {
      let newArr = arr[i].split("=");
      if (newArr[0] === name) {
        return newArr[1];
      }
    }
  },
  del: function (name) {
    this.set(name, "", -1);
  },
};

```

## 3、DOM操作

### **1、Js获取元素样式【支持内联】**

- 

```javascript
const getRealStyle = function (obj, styleName) {
  // Js获取元素样式【支持内联】
  var realStyle = null;
  if (obj.currentStyle) {
    realStyle = obj.currentStyle[styleName];
  } else if (window.getComputedStyle) {
    realStyle = window.getComputedStyle(obj, null)[styleName];
  }
  return realStyle;
};

```

### **2、文本复制功能**

- 

```javascript
const copyTxt = function (text, fn) {
  // 复制功能
  if (typeof document.execCommand !== "function") {
    console.log("复制失败，请长按复制");
    return;
  }
  var dom = document.createElement("textarea");
  dom.value = text;
  dom.setAttribute("style", "display: block;width: 1px;height: 1px;");
  document.body.appendChild(dom);
  dom.select();
  var result = document.execCommand("copy");
  document.body.removeChild(dom);
  if (result) {
    console.log("复制成功");
    typeof fn === "function" && fn();
    return;
  }
  if (typeof document.createRange !== "function") {
    console.log("复制失败，请长按复制");
    return;
  }
  var range = document.createRange();
  var div = document.createElement("div");
  div.innerhtml = text;
  div.setAttribute("style", "height: 1px;fontSize: 1px;overflow: hidden;");

  document.body.appendChild(div);
  range.selectNode(div);
  var selection = window.getSelection();
  console.log(selection);
  if (selection.rangeCount > 0) {
    selection.removeAllRanges();
  }
  selection.addRange(range);
  document.execCommand("copy");
  typeof fn === "function" && fn();
  console.log("复制成功");
};

```

### **3、原生世界操作**



```javascript
const dom = {
  $: function (selector) {
    let type = selector.substring(0, 1);
    if (type === "#") {
      if (document.querySelecotor) return document.querySelector(selector);
      return document.getElementById(selector.substring(1));
    } else if (type === ".") {
      if (document.querySelecotorAll)
        return document.querySelectorAll(selector);
      return document.getElementsByClassName(selector.substring(1));
    } else {
      return document[
        "querySelectorAll" ? "querySelectorAll" : "getElementsByTagName"
      ](selector);
    }
  },
  hasClass: function (ele, name) {
    /* 检测类名 */
    return ele.className.match(new RegExp("(\\s|^)" + name + "(\\s|$)"));
  },
  addClass: function (ele, name) {
    /* 添加类名 */
    if (!this.hasClass(ele, name)) ele.className += " " + name;
  },
  removeClass: function (ele, name) {
    /* 删除类名 */
    if (this.hasClass(ele, name)) {
      let reg = new RegExp("(\\s|^)" + name + "(\\s|$)");
      ele.className = ele.className.replace(reg, "");
    }
  },
  replaceClass: function (ele, newName, oldName) {
    /* 替换类名 */
    this.removeClass(ele, oldName);
    this.addClass(ele, newName);
  },
  siblings: function (ele) {
    /* 获取兄弟节点 */
    console.log(ele.parentNode);
    let chid = ele.parentNode.children,
      eleMatch = [];
    for (let i = 0, len = chid.length; i < len; i++) {
      if (chid[i] !== ele) {
        eleMatch.push(chid[i]);
      }
    }
    return eleMatch;
  },
  getByStyle: function (obj, name) {
    /* 获取行间样式属性 */
    if (obj.currentStyle) {
      return obj.currentStyle[name];
    } else {
      return getComputedStyle(obj, false)[name];
    }
  },
  domToStirng: function (htmlDOM) {
    /* DOM转字符串 */
    var div = document.createElement("div");
    div.appendChild(htmlDOM);
    return div.innerHTML;
  },
  stringToDom: function (htmlString) {
    /* 字符串转DOM */
    var div = document.createElement("div");
    div.innerHTML = htmlString;
    return div.children[0];
  },
};

```

### **4、判断图片加载完成**



```javascript
const imgLoadAll = function (arr, callback) {
  // 图片加载
  let arrImg = [];
  for (let i = 0; i < arr.length; i++) {
    let img = new Image();
    img.src = arr[i];
    img.onload = function () {
      arrImg.push(this);
      if (arrImg.length == arr.length) {
        callback && callback();
      }
    };
  }
};

```

### **5、广播加载完成操作**



```javascript
const loadAudio = function(src, callback) { 
// 音频加载  
var audio = new Audio(src) 
audio.onloadedmetadata = callback 
    audio.src = src
}
```

### **6、不同位置光标字符**

- 

```javascript
/** * 光标所在位置插入字符，并设置光标位置 *  * @param {dom} 输入框 * @param {val} 插入的值 * @param {posLen} 光标位置处在 插入的值的哪个位置   */   
setCursorPosition (dom,val,posLen) {  
    var cursorPosition = 0; 
    if(dom.selectionStart){   
        cursorPosition = dom.selectionStart;
    }   
    this.insertAtCursor(dom,val);  
    dom.focus();  
    console.log(posLen)  
    dom.setSelectionRange(dom.value.length,cursorPosition + (posLen || val.length));   
}

/*光标所在位置插入字符*/

insertAtCursor(dom, val) { 
    if (document.selection){     
        dom.focus();       
        sel = document.selection.createRange();      
        sel.text = val;      
        sel.select();  
    }else if (dom.selectionStart || dom.selectionStart == '0'){  
        let startPos = dom.selectionStart;  
        let endPos = dom.selectionEnd;     
        let restoreTop = dom.scrollTop;    
        dom.value = dom.value.substring(0, startPos) + val + dom.value.substring(endPos, dom.value.length);  
        if (restoreTop > 0){        
            dom.scrollTop = restoreTop;   
        }      
        dom.focus();  
        dom.selectionStart = startPos + val.length;    
        dom.selectionEnd = startPos + val.length;  
    } else {      
        dom.value += val;   
        dom.focus();  
    }
}
```

### **7、图片地址转base64**

- 

```javascript
const getBase64 = function (img) {
  //传入图片路径，返回base64，使用getBase64(url).then(function(base64){},function(err){});
  let getBase64Image = function (img, width, height) {
    //width、height调用时传入具体像素值，控制大小,不传则默认图像大小
    let canvas = document.createElement("canvas");
    canvas.width = width ? width : img.width;
    canvas.height = height ? height : img.height;
    let ctx = canvas.getContext("2d");
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
    let dataURL = canvas.toDataURL();
    return dataURL;
  };
  let image = new Image();
  image.crossOrigin = "";
  image.src = img;
  let deferred = $.Deferred();
  if (img) {
    image.onload = function () {
      deferred.resolve(getBase64Image(image));
    };
    return deferred.promise();
  }
};

```

### **8、base64图片下载功能**

- 

```javascript
const downloadFile = function (base64, fileName) {
  //base64图片下载功能
  let base64ToBlob = function (code) {
    let parts = code.split(";base64,");
    let contentType = parts[0].split(":")[1];
    let raw = window.atob(parts[1]);
    let rawLength = raw.length;
    let uInt8Array = new Uint8Array(rawLength);
    for (let i = 0; i < rawLength; ++i) {
      uInt8Array[i] = raw.charCodeAt(i);
    }
    return new Blob([uInt8Array], { type: contentType });
  };
  let aLink = document.createElement("a");
  let blob = base64ToBlob(base64);
  //new Blob([content]);
  let evt = document.createEvent("HTMLEvents");
  evt.initEvent("click", true, true);
  //initEvent不加后两个参数在FF下会报错  事件类型，是否冒泡，是否阻止浏览器的默认行为
  aLink.download = fileName;
  aLink.href = URL.createObjectURL(blob);
  aLink.click();
};
```

### **9、H5软键盘缩回、弹起键盘**



```javascript
const h5Resize = function (downCb, upCb) {
  //当软件键盘弹起会改变当前 window.innerHeight，监听这个值变化 [downCb 当软键盘弹起后，缩回的回调,upCb 当软键盘弹起的回调]
  var clientHeight = window.innerHeight;
  downCb = typeof downCb === "function" ? downCb : function () {};
  upCb = typeof upCb === "function" ? upCb : function () {};
  window.addEventListener("resize", () => {
    var height = window.innerHeight;
    if (height === clientHeight) {
      downCb();
    }
    if (height < clientHeight) {
      upCb();
    }
  });
};

```

### 10 获取当前节点及父节点

```javascript
  getFamilyTree(arr1, menuCode) {
      // 获取当前节点及父节点的code
      var temp = [];
      var forFn = function (arr, menuCode) {
        for (var i = 0; i < arr.length; i++) {
          var item = arr[i];
          if (item.menuCode === menuCode) {
            temp.push(item.menuCode);
            forFn(arr1, item.parentCode);
            break;
          } else {
            if (item.children) {
              forFn(item.children, menuCode);
            }
          }
        }
      };
      forFn(arr1, menuCode);
      return temp;
    },
```

### 11、 dom操作

```javascript
$ (selector){ 
    var type = selector.substring(0, 1); 
    if (type === '#') {     
        if (document.querySelecotor) return document.querySelector(selector)  
        return document.getElementById(selector.substring(1))  
    }else if (type === '.') {    
        if (document.querySelecotorAll) return document.querySelectorAll(selector)   
        return document.getElementsByClassName(selector.substring(1)) 
    }else{   
        return document['querySelectorAll' ? 'querySelectorAll':'getElementsByTagName'](selector) 
    }}
```

### 12、获取兄弟节点

```javascript
/*获取兄弟节点*/
siblings (ele) {  
    console.log(ele.parentNode) 
    var chid = ele.parentNode.children,eleMatch = [];    
    for(var i = 0, len = chid.length; i < len; i ++){   
        if(chid[i] != ele){          
            eleMatch.push(chid[i]);    
        }   
    }     
    return eleMatch;
}

```

### 13、操作文件

> 上传文件时对文件后缀名做检查

```javascript
	if (!filename || !(filename.endsWith('.jpg') || filename.endsWith('.png') || filename.endsWith('.gif'))) {
		alert('Can only upload image file.');
		return false;
	}
	H5读取文件内容：
			var
			fileInput = document.getElementById('test-image-file'),
			info = document.getElementById('test-file-info'),
			preview = document.getElementById('test-image-preview');
		// 监听change事件:
		fileInput.addEventListener('change', function () {
			// 清除背景图片:
			preview.style.backgroundImage = '';
			// 检查文件是否选择:
			if (!fileInput.value) {
				info.innerHTML = '没有选择文件';
				return;
			}
			// 获取File引用:
			var file = fileInput.files[0];
			// 获取File信息:
			info.innerHTML = '文件: ' + file.name + '<br>' +
							 '大小: ' + file.size + '<br>' +
							 '修改: ' + file.lastModifiedDate;
			if (file.type !== 'image/jpeg' && file.type !== 'image/png' && file.type !== 'image/gif') {
				alert('不是有效的图片文件!');
				return;
			}
			// 读取文件:
			var reader = new FileReader();
			reader.onload = function(e) {
				var data = e.target.result; // 'data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...'            
				preview.style.backgroundImage = 'url(' + data + ')';
			};
			// 以DataURL的形式读取文件:
			reader.readAsDataURL(file);
		});
```

### 

## **4、时间**



### **1、时间格式化**

```javascript
const formatDate = function (fmt, date) {
  // 时间格式化 【'yyyy-MM-dd hh:mm:ss',时间】
  if (typeof date !== "object") {
    date = !date ? new Date() : new Date(date);
  }
  var o = {
    "M+": date.getMonth() + 1, // 月份
    "d+": date.getDate(), // 日
    "h+": date.getHours(), // 小时
    "m+": date.getMinutes(), // 分
    "s+": date.getSeconds(), // 秒
    "q+": Math.floor((date.getMonth() + 3) / 3), // 季度
    S: date.getMilliseconds(), // 毫秒
  };
  if (/(y+)/.test(fmt)) {
    fmt = fmt.replace(
      RegExp.$1,
      (date.getFullYear() + "").substr(4 - RegExp.$1.length)
    );
  }
  for (var k in o) {
    if (new RegExp("(" + k + ")").test(fmt)) {
      fmt = fmt.replace(
        RegExp.$1,
        RegExp.$1.length === 1 ? o[k] : ("00" + o[k]).substr(("" + o[k]).length)
      );
    }
  }
  return fmt;
};

```

### **2、时间与时间转换**

- 

```javascript
const stamp = {
  // 时间，时间戳转换
  getTime: function (time) {
    // 时间转10位时间戳
    let date = time ? new Date(time) : new Date();
    return Math.round(date.getTime() / 1000);
  },
  timeToStr: function (time, fmt) {
    // 10位时间戳转时间
    return new Date(time * 1000).pattern(fmt || "yyyy-MM-dd");
  },
};

```

### 3、 时间处理



```javascript
/**

 * 格式化时间

 * 

 * @param  {time} 时间

 * @param  {cFormat} 格式

 * @return {String} 字符串
   *

 * @example formatTime('2018-1-29', '{y}/{m}/{d} {h}:{i}:{s}') // -> 2018/01/29 00:00:00
   */
   formatTime(time, cFormat) {
   if (arguments.length === 0) return null
   if ((time + '').length === 10) {
       time = +time * 1000
   }

   var format = cFormat || '{y}-{m}-{d} {h}:{i}:{s}', date
   if (typeof time === 'object') {
       date = time
   } else {
       date = new Date(time)
   }

   var formatObj = {
       y: date.getFullYear(),
       m: date.getMonth() + 1,
       d: date.getDate(),
       h: date.getHours(),
       i: date.getMinutes(),
       s: date.getSeconds(),
       a: date.getDay()
   }
   var time_str = format.replace(/{(y|m|d|h|i|s|a)+}/g, (result, key) => {
       var value = formatObj[key]
       if (key === 'a') return ['一', '二', '三', '四', '五', '六', '日'][value - 1]
       if (result.length > 0 && value < 10) {
           value = '0' + value
       }
       return value || 0
   })
   return time_str
   }


/**

 * 返回指定长度的月份集合
 * 
 * @param  {time} 时间
 * @param  {len} 长度
 * @param  {direction} 方向：  1: 前几个月;  2: 后几个月;  3:前后几个月  默认 3
 * @return {Array} 数组
 * 
 * @example   getMonths('2018-1-29', 6, 1)  // ->  ["2018-1", "2017-12", "2017-11", "2017-10", "2017-9", "2017-8", "2017-7"]
   */
getMonths(time, len, direction) {
   var mm = new Date(time).getMonth(),
       yy = new Date(time).getFullYear(),
       direction = isNaN(direction) ? 3 : direction,
       index = mm;
   var cutMonth = function(index) {
       if ( index <= len && index >= -len) {
           return direction === 1 ? formatPre(index).concat(cutMonth(++index)):
               direction === 2 ? formatNext(index).concat(cutMonth(++index)):formatCurr(index).concat(cutMonth(++index))
       }
       return []
   }
   var formatNext = function(i) {
       var y = Math.floor(i/12),
           m = i%12
       return [yy+y + '-' + (m+1)]
   }
   var formatPre = function(i) {
       var y = Math.ceil(i/12),
           m = i%12
       m = m===0 ? 12 : m
       return [yy-y + '-' + (13 - m)]
   }
   var formatCurr = function(i) {
       var y = Math.floor(i/12),
           yNext = Math.ceil(i/12),
           m = i%12,
           mNext = m===0 ? 12 : m
       return [yy-yNext + '-' + (13 - mNext),yy+y + '-' + (m+1)]
   }
   
    * 
   // 数组去重
   var unique = function(arr) {
       if ( Array.hasOwnProperty('from') ) {
           return Array.from(new Set(arr));
       }else{
           var n = {},r=[]; 
           for(var i = 0; i < arr.length; i++){
               if (!n[arr[i]]){
                   n[arr[i]] = true; 
                   r.push(arr[i]);
               }
           }
           return r;
       }
   }
   return direction !== 3 ? cutMonth(index) : unique(cutMonth(index).sort(function(t1, t2){
       return new Date(t1).getTime() - new Date(t2).getTime()
   }))
   }



/**

 * 返回指定长度的天数集合
 * 
 * @param  {time} 时间
 * @param  {len} 长度
 * @param  {direction} 方向： 1: 前几天;  2: 后几天;  3:前后几天  默认 3
 * @return {Array} 数组
   *
 * @example date.getDays('2018-1-29', 6) // -> ["2018-1-26", "2018-1-27", "2018-1-28", "2018-1-29", "2018-1-30", "2018-1-31", "2018-2-1"]
   */
   getDays(time, len, diretion) {
   var tt = new Date(time)
   var getDay = function(day) {
       var t = new Date(time)
       t.setDate(t.getDate() + day)
       var m = t.getMonth()+1
       return t.getFullYear()+'-'+m+'-'+t.getDate()
   }
   var arr = []
   if (diretion === 1) {
       for (var i = 1; i <= len; i++) {
           arr.unshift(getDay(-i))
       }
   }else if(diretion === 2) {
       for (var i = 1; i <= len; i++) {
           arr.push(getDay(i))
       }
   }else {
       for (var i = 1; i <= len; i++) {
           arr.unshift(getDay(-i))
       }
       arr.push(tt.getFullYear()+'-'+(tt.getMonth()+1)+'-'+tt.getDate())
       for (var i = 1; i <= len; i++) {
           arr.push(getDay(i))
       }
   }
   return diretion === 1 ? arr.concat([tt.getFullYear()+'-'+(tt.getMonth()+1)+'-'+tt.getDate()]) : 
       diretion === 2 ? [tt.getFullYear()+'-'+(tt.getMonth()+1)+'-'+tt.getDate()].concat(arr) : arr
   }


/**

 * @param  {s} 秒数
 * @return {String} 字符串 
   *
 * @example formatHMS(3610) // -> 1h0m10s
   */
   formatHMS (s) {
   var str = ''
   if (s > 3600) {
       str = Math.floor(s/3600)+'h'+Math.floor(s%3600/60)+'m'+s%60+'s'
   }else if(s > 60) {
       str = Math.floor(s/60)+'m'+s%60+'s'
   }else{
       str = s%60+'s'
   }
   return str
   }

/*获取某月有多少天*/
getMonthOfDay (time) {
    var date = new Date(time)
    var year = date.getFullYear()
    var mouth = date.getMonth() + 1
    var days

    //当月份为二月时，根据闰年还是非闰年判断天数
    if (mouth == 2) {
        days = year % 4 == 0 ? 29 : 28
    } else if (mouth == 1 || mouth == 3 || mouth == 5 || mouth == 7 || mouth == 8 || mouth == 10 || mouth == 12) {
        //月份为：1,3,5,7,8,10,12 时，为大月.则天数为31；
        days = 31
    } else {
        //其他月份，天数为：30.
        days = 30
    }
    return days

}

/*获取某年有多少天*/
getYearOfDay (time) {
    var firstDayYear = this.getFirstDayOfYear(time);
    var lastDayYear = this.getLastDayOfYear(time);
    var numSecond = (new Date(lastDayYear).getTime() - new Date(firstDayYear).getTime())/1000;
    return Math.ceil(numSecond/(24*3600));
}

/*获取某年的第一天*/
getFirstDayOfYear (time) {
    var year = new Date(time).getFullYear();
    return year + "-01-01 00:00:00";
}

/*获取某年最后一天*/
getLastDayOfYear (time) {
    var year = new Date(time).getFullYear();
    var dateString = year + "-12-01 00:00:00";
    var endDay = this.getMonthOfDay(dateString);
    return year + "-12-" + endDay + " 23:59:59";
}

/*获取某个日期是当年中的第几天*/
getDayOfYear (time) {
    var firstDayYear = this.getFirstDayOfYear(time);
    var numSecond = (new Date(time).getTime() - new Date(firstDayYear).getTime())/1000;
    return Math.ceil(numSecond/(24*3600));
}

/*获取某个日期在这一年的第几周*/
getDayOfYearWeek (time) {
    var numdays = this.getDayOfYear(time);
    return Math.ceil(numdays / 7);
}
var now = new Date(); //当前日期
var nowDayOfWeek = now.getDay(); //今天本周的第几天
var nowDay = now.getDate(); //当前日
var nowMonth = now.getMonth(); //当前月
var nowYear = now.getYear(); //当前年
nowYear += (nowYear < 2000) ? 1900 : 0; //

//格局化日期：yyyy-MM-dd
function formatDate(date) {
var myyear = date.getFullYear();
var mymonth = date.getMonth()+1;
var myweekday = date.getDate();

if(mymonth < 10){
mymonth = "0" + mymonth;
}
if(myweekday < 10){
myweekday = "0" + myweekday;
}
return (myyear+"-"+mymonth + "-" + myweekday);
}

//获得某月的天数
function getMonthDays(myMonth){
var monthStartDate = new Date(nowYear, myMonth, 1);
var monthEndDate = new Date(nowYear, myMonth + 1, 1);
var days = (monthEndDate - monthStartDate)/(1000 * 60 * 60 * 24);
return days;
}

/

//获得本周的开端日期
function getWeekStartDate() {
var weekStartDate = new Date(nowYear, nowMonth, nowDay - nowDayOfWeek);
return formatDate(weekStartDate);
}

//获得本周的停止日期
function getWeekEndDate() {
var weekEndDate = new Date(nowYear, nowMonth, nowDay + (6 - nowDayOfWeek));
return formatDate(weekEndDate);
}

//获得本月的开端日期
function getMonthStartDate(){
var monthStartDate = new Date(nowYear, nowMonth, 1);
return formatDate(monthStartDate);
}

//获得本月的停止日期
function getMonthEndDate(){
var monthEndDate = new Date(nowYear, nowMonth, getMonthDays(nowMonth));
return formatDate(monthEndDate);
} 

// 日期之间的时间差
const daysBetween = (date1, date2) => Math.ceil(Math.abs(date1 - date2) / (1000 * 60 * 60 * 24));
```

###  4、 unix时间戳

```javascript
(new Date).valueOf();
+new Date
```

### 

## 5、http请求

### **1、原生ajax操作**



```javascript
const ajax = function (conf) {
  // ajax操作
  let url = conf.url,
    data = conf.data,
    senData = [],
    // 封装后的数据
    async = conf.async !== undefined ? conf.async : true,
    // ture为异步请求
    type = conf.type || "get",
    // 默认请求方式get
    dataType = conf.dataType || "json",
    contenType = conf.contenType || "application/x-www-form-urlencoded",
    success = conf.success,
    error = conf.error,
    isForm = conf.isForm || false, // 是否formdata
    header = conf.header || {}, // 头部信息
    xhr = ""; // 创建ajax引擎对象
  if (data == null) {
    senData = "";
  } else if (typeof data === "object" && !isForm) {
    // 如果data是对象，转换为字符串
    for (var k in data) {
      senData.push(encodeURIComponent(k) + "=" + encodeURIComponent(data[k]));
    }
    senData = senData.join("&");
  } else {
    senData = data;
  }
  try {
    xhr = new ActiveXObject("microsoft.xmlhttp"); // IE内核系列浏览器
  } catch (e1) {
    try {
      xhr = new XMLHttpRequest(); // 非IE内核浏览器
    } catch (e2) {
      if (error != null) {
        error("不支持ajax请求");
      }
    }
  }
  xhr.open(type, type !== "get" ? url : url + "?" + senData, async);
  if (type !== "get" && !isForm) {
    xhr.setRequestHeader("content-type", contenType);
  }
  for (var h in header) {
    xhr.setRequestHeader(h, header[h]);
  }
  xhr.send(type !== "get" ? senData : null);
  xhr.onreadystatechange = function () {
    if (xhr.readyState === 4) {
      if (xhr.status >= 200 && xhr.status < 300) {
        if (dataType === "json" && success != null) {
          let res = "";
          try {
            res = eval("(" + xhr.responseText + ")");
          } catch (e) {
            console.log(e);
          }
          success(res); // 将json字符串转换为js对象       
        };    
      } else {     
          if (error != null) {
          error("通讯失败!" + xhr.status);
        }
      }
    }
  };
};

```

### 2、 ajax请求

```javascript
 /* @param  {setting}   */  
ajax(setting){   
    //设置参数的初始值   
    var opts={      
        method: (setting.method || "GET").toUpperCase(), 
        //请求方式      
        url: setting.url || "", 
        // 请求地址       
        async: setting.async || true, 
        // 是否异步       
        dataType: setting.dataType || "json", 
        // 解析方式       
        data: setting.data || "", 
        // 参数       
        success: setting.success || function(){},
        // 请求成功回调       
        error: setting.error || function(){} 
        // 请求失败回调   
    }   
    // 参数格式化  
    function params_format (obj) {      
        var str = ''      
        for (var i in obj) {    
            str += i + '=' + obj[i] + '&'      
        }      
        return str.split('').slice(0, -1).join('') 
    }   
    // 创建ajax对象   
    var xhr=new XMLHttpRequest();  
    // 连接服务器open(方法GET/POST，请求地址， 异步传输)  
    if(opts.method == 'GET'){    
        xhr.open(opts.method, opts.url + "?" + params_format(opts.data), opts.async);   
        xhr.send();   
    }else{    
            xhr.open(opts.method, opts.url, opts.async);    
                          
        xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");      
        xhr.send(opts.data);   
    }  
    /*   ** 每当readyState改变时，就会触发onreadystatechange事件   ** readyState属性存储有XMLHttpRequest的状态信息   ** 0 ：请求未初始化   ** 1 ：服务器连接已建立   ** 2 ：请求已接受   ** 3 : 请求处理中   ** 4 ：请求已完成，且相应就绪   */ 
    xhr.onreadystatechange = function() {   
        if (xhr.readyState === 4 && (xhr.status === 200 || xhr.status === 304)) {          
            switch(opts.dataType){        
                case "json":                 
                    var json = JSON.parse(xhr.responseText);                
                    opts.success(json);                   
                    break;              
                case "xml":                 
                    opts.success(xhr.responseXML);             
                    break;            
                default:                
                    opts.success(xhr.responseText);       
                    break;         
            }      
        }   
    }   
    xhr.onerror = function(err) {   
        opts.error(err);  
    }  
}
/** * @param  {url} * @param  {setting} * @return {Promise}   */ 
fetch(url, setting) { 
    //设置参数的初始值  
    let opts={     
        method: (setting.method || 'GET').toUpperCase(),
        //请求方式      
        headers : setting.headers  || {}, 
        // 请求头设置     
        credentials : setting.credentials  || true, 
        // 设置cookie是否一起发送     
        body: setting.body || {},     
        mode : setting.mode  || 'no-cors', 
        // 可以设置 cors, no-cors, same-origin      
        redirect : setting.redirect  || 'follow',
        // follow, error, manual       
        cache : setting.cache  || 'default' // 设置 cache 模式 (default, reload, no-cache)  
    }   let dataType = setting.dataType || "json", // 解析方式       
        data = setting.data || "" // 参数  
    // 参数格式化   
    function params_format (obj) {    
        var str = ''      
        for (var i in obj) {   
            str += `${i}=${obj[i]}&`    
        }     
        return str.split('').slice(0, -1).join('')  
    }  
    if (opts.method === 'GET') {    
        url = url + (data?`?${params_format(data)}`:'') 
    }else{  
            setting.body = data || {} 
    }  
    return new Promise( (resolve, reject) => {    
        fetch(url, opts).then( async res => {    
            let data = dataType === 'text' ? await res.text() : dataType === 'blob' ? await res.blob() : await res.json()            resolve(data)      
        }).catch( e => {    
            reject(e)    
        })  
    })}
```

 * 

### **3、fetch请求的封装**

- 

```javascript
const fetch = function (url, setting) {
  // fetch请求的封装
  let opts = {
    // 设置参数的初始值
    method: (setting.method || "GET").toUpperCase(),
    // 请求方式
    headers: setting.headers || {},
    // 请求头设置
    credentials: setting.credentials || true,
    // 设置cookie是否一起发送
    body: setting.body || {},
    mode: setting.mode || "no-cors", // 可以设置 cors, no-cors, same-origin
    redirect: setting.redirect || "follow", // follow, error, manual
    cache: setting.cache || "default", // 设置 cache 模式 (default, reload, no-cache)
  };
  let dataType = setting.dataType || "json"; // 解析方式
  let data = setting.data || ""; // 参数
  let paramsFormat = function (obj) {
    // 参数格式
    var str = "";
    for (var i in obj) {
      str += `${i}=${obj[i]}&`;
    }
    return str.split("").slice(0, -1).join("");
  };
  if (opts.method === "GET") {
    url = url + (data ? `?${paramsFormat(data)}` : "");
  } else {
    setting.body = data || {};
  }
  return new Promise((resolve, reject) => {
    fetch(url, opts)
      .then(async (res) => {
        let data =
          dataType === "text"
            ? await res.text()
            : dataType === "blob"
            ? await res.blob()
            : await res.json();
        resolve(data);
      })
      .catch((e) => {
        reject(e);
      });
  });
};

```

## **6、设备、运行环境判断**

- ### 1、android、ios、web

```javascript
const isDevice = function () {
  // 判断是android还是ios还是web
  var ua = navigator.userAgent.toLowerCase();
  if (ua.match(/iPhone\sOS/i) === "iphone os" || ua.match(/iPad/i) === "ipad") {
    // ios
    return "iOS";
  }
  if (ua.match(/Android/i) === "android") {
    return "Android";
  }
  return "Web";
};

```

### **2、判断是否为微信**

- 

```javascript
const isWx = function () {
  // 判断是否为微信
  var ua = window.navigator.userAgent.toLowerCase();
  if (ua.match(/MicroMessenger/i) === "micromessenger") {
    return true;
  }
  return false;
};

```

### **3、运行环境判断**

- 

```javascript
// 手机环境
isIos () {
    var u = navigator.userAgent;
    if (u.indexOf('Android') > -1 || u.indexOf('Linux') > -1) {//安卓手机
        // return "Android";
        return false
    } else if (u.indexOf('iPhone') > -1) {//苹果手机
        // return "iPhone";
        return true
    } else if (u.indexOf('iPad') > -1) {//iPad
        // return "iPad";
        return false
    } else if (u.indexOf('Windows Phone') > -1) {//winphone手机
        // return "Windows Phone";
        return false
    }else{
        return false
    }
}

isPC () { //是否为PC端
    var userAgentInfo = navigator.userAgent;
    var Agents = ["Android", "iPhone",
                "SymbianOS", "Windows Phone",
                "iPad", "iPod"];
    var flag = true;
    for (var v = 0; v < Agents.length; v++) {
        if (userAgentInfo.indexOf(Agents[v]) > 0) {
            flag = false;
            break;
        }
    }
    return flag;
}

// 浏览器环境
browserType(){
    var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串
    var isOpera = userAgent.indexOf("Opera") > -1; //判断是否Opera浏览器
    var isIE = userAgent.indexOf("compatible") > -1 && userAgent.indexOf("MSIE") > -1 && !isOpera; //判断是否IE浏览器
    var isEdge = userAgent.indexOf("Edge") > -1; //判断是否IE的Edge浏览器
    var isFF = userAgent.indexOf("Firefox") > -1; //判断是否Firefox浏览器
    var isSafari = userAgent.indexOf("Safari") > -1 && userAgent.indexOf("Chrome") == -1; //判断是否Safari浏览器
    var isChrome = userAgent.indexOf("Chrome") > -1 && userAgent.indexOf("Safari") > -1; //判断Chrome浏览器
    if (isIE) {
        var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
        reIE.test(userAgent);
        var fIEVersion = parseFloat(RegExp["$1"]);
        if(fIEVersion == 7) return "IE7"
        else if(fIEVersion == 8) return "IE8";
        else if(fIEVersion == 9) return "IE9";
        else if(fIEVersion == 10) return "IE10";
        else if(fIEVersion == 11) return "IE11";
        else return "IE7以下"//IE版本过低
    }

    if (isFF) return "FF";
    if (isOpera) return "Opera";
    if (isEdge) return "Edge";
    if (isSafari) return "Safari";
    if (isChrome) return "Chrome";

}


```

### 3、**检查设备上的触摸支持**

```javascript
const touchSupported = () => ('ontouchstart' in window || DocumentTouch && document instanceof DocumentTouch)
```

### 

## 7、数组

### **1、判断是否是一个数组**

- 

```
const isArray = function(arr) { 
// 判断是否是一个数组 
return Object.prototype.toString.call(arr) === '[object Array]'}
```

### **2、判断两个数组是否相等**

- 

```javascript
const arrayEqual = function (arr1, arr2) {
  //判断两个数组是否相等
  if (arr1 === arr2) return true;
  if (arr1.length != arr2.length) return false;
  for (let i = 0; i < arr1.length; ++i) {
    if (arr1[i] !== arr2[i]) return false;
  }
  return true;
};

```

### 3、 打乱数组中元素顺序（类似音乐随机播放）

```javascript
function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1) + min)
}

export function shuffle(arr) {
  let _arr = arr.slice()
  for (let i = 0; i < _arr.length; i++) {
	let j = getRandomInt(0, i)
	let t = _arr[i]
	_arr[i] = _arr[j]

	_arr[j] = t
  }
  return _arr
}
```

### 4、判断一个元素是否在数组中

```javascript
function contains (arr, val) {
    return arr.indexOf(val) != -1 ? true : false;
}
```



### 5、实现一个each和map

```javascript
 /** 
 @param  {arr} 数组
 * @param  {fn} 回调函数
 * @return {undefined}
   */
  function each (arr, fn) {
       fn = fn || Function;
       var a = [];
       var args = Array.prototype.slice.call(arguments, 1);
       for(var i = 0; i < arr.length; i++) {
           var res = fn.apply(arr, [arr[i], i].concat(args));
           if(res != null) a.push(res);
       }
   }
/**

 * @param  {arr} 数组
 * @param  {fn} 回调函数
 * @param  {thisObj} this指向
 * @return {Array} 
   */
 function  map (arr, fn, thisObj) {
       var scope = thisObj || window;
       var a = [];
       for(var i = 0, j = arr.length; i < j; ++i) {
           var res = fn.call(scope, arr[i], i, this);
           if(res != null) a.push(res);
       }
       return a;
   }
```

### 6、数组排序

```javascript
/**

 * @param  {arr} 数组
 * @param  {type} 1：从小到大   2：从大到小   3：随机
 * @return {Array}
   */
   sort (arr, type = 1) {
       return arr.sort( (a, b) => {
           switch(type) {
               case 1:
                   return a - b;
               case 2:
                   return b - a;
               case 3:
                   return Math.random() - 0.5;
               default:
                   return arr;
           }
       })
   }
```



### 7、去重

```javascript
unique (arr) {
    if ( Array.hasOwnProperty('from') ) {
        return Array.from(new Set(arr));
    }else{
        var n = {},r=[]; 
        for(var i = 0; i < arr.length; i++){
            if (!n[arr[i]]){
                n[arr[i]] = true; 
                r.push(arr[i]);
            }
        }
        return r;
    }
}
```

### 8、数组扁平化

```javascript
export const flatten = (arr) => {
  let result = [];

  for(let i = 0; i < arr.length; i++) {
    if(Array.isArray(arr[i])) {
      result = result.concat(flatten(arr[i]));
    } else {
      result.push(arr[i]);
    }
  }
  return result;
}
```

### 9.数组常用操作

```javascript
/* 求两个集合的并集*/
union (a, b) { 
    var newArr = a.concat(b);    
    return this.unique(newArr);
}
/*求两个集合的交集*/
intersect (a, b) { 
    var _this = this;   
    a = this.unique(a);    
    return this.map(a, function(o) {        
        return _this.contains(b, o) ? o : null;    
    });
}
/*删除其中一个元素*/
remove (arr, ele) {    
    var index = arr.indexOf(ele);    
    if(index > -1) {        
        arr.splice(index, 1);    
    }   
    return arr;
}
/*将类数组转换为数组的方法*/
formArray (ary) {    
    var arr = [];    
    if(Array.isArray(ary)) {       
        arr = ary;    
    } else {        
        arr = Array.prototype.slice.call(ary);    
    };    
    return arr;
}
/*最大值*/
max (arr) {    
    return Math.max.apply(null, arr);
}
/*最小值*/
min (arr) {    
    return Math.min.apply(null, arr);
}
/*求和*/
sum (arr) {    
    return arr.reduce( (pre, cur) => {        
        return pre + cur   
    })}
/*平均值*/
average (arr) {   
    return this.sum(arr)/arr.length
}

function randomOne(arr) {
	return arr[Math.floor(Math.random() * arr.length)];
}
/* 从数组中随机获取元素*/

function randomOne(arr) {
	return arr[Math.floor(Math.random() * arr.length)];
}

/* 返回数组（字符串）一个元素出现的次数*/

//getEleCount('asd56+asdasdwqe','a')
//3
//getEleCount([1,2,3,4,5,66,77,22,55,22],22)
//2
function getEleCount (obj, ele) {
	var num = 0;
	for (var i = 0, len = obj.length; i < len; i++) {
		if (ele == obj[i]) {
			num++;
		}
	}
	return num;
}

/* 返回数组（字符串）出现最多的几次元素和出现次数 */
//arr, rank->长度，默认为数组长度，ranktype，排序方式，默认降序
function getCount(arr, rank，ranktype){ 
	var obj = {}, k, arr1 = []
	//记录每一元素出现的次数
	for (var i = 0, len = arr.length; i < len; i++) {
		k = arr[i];
		if (obj[k]) {
			obj[k]++;
		}
		else {
			obj[k] = 1;
		}
	}
	//保存结果{el-'元素'，count-出现次数}
	for (var o in obj) {
		arr1.push({el: o, count: obj[o]});
	}
	//排序（降序）
	arr1.sort(function (n1, n2) {
		return n2.count - n1.count
	});
	//如果ranktype为1，则为升序，反转数组
	if(ranktype===1){
		arr1=arr1.reverse();
	}
	var rank1 = rank || arr1.length;
	return arr1.slice(0,rank1);
}
getCount([1,2,3,1,2,5,2,4,1,2,6,2,1,3,2])
//默认情况，返回所有元素出现的次数

getCount([1,2,3,1,2,5,2,4,1,2,6,2,1,3,2],3)
//传参（rank=3），只返回出现次数排序前三的

getCount([1,2,3,1,2,5,2,4,1,2,6,2,1,3,2],null,1)
//传参（ranktype=1,rank=null），升序返回所有元素出现次数

getCount([1,2,3,1,2,5,2,4,1,2,6,2,1,3,2],3,1)
//传参（rank=3，ranktype=1），只返回出现次数排序（升序）前三的


/* 得到n1-n2下标的数组 */
//getArrayNum([0,1,2,3,4,5,6,7,8,9],5,9)
//[5, 6, 7, 8, 9]

//getArrayNum([0,1,2,3,4,5,6,7,8,9],2) 不传第二个参数,默认返回从n1到数组结束的元素
//[2, 3, 4, 5, 6, 7, 8, 9]
function getArrayNum(arr,n1,n2){
	var arr1=[],len=n2||arr.length-1;
	for(var i=n1;i<=len;i++){
		arr1.push(arr[i])
	}
	return arr1;
}

/* 筛选数组 */

//删除值为'val'的数组元素
//removeArrayForValue(['test','test1','test2','test','aaa'],'test','%')
//["aaa"]   带有'test'的都删除
	
//removeArrayForValue(['test','test1','test2','test','aaa'],'test')
//["test1", "test2", "aaa"]  //数组元素的值全等于'test'才被删除
function removeArrayForValue(arr,val,type){
	arr.filter(function(item){return type==='%'?item.indexOf(val)!==-1:item!==val})
}

```

###  10、1维数组转换成树状结构

```javascript
export function getTree(data) {
    let parents = data.filter(value => value.pId == '0' || value.pId == null)// 过滤父节点
    let children = data.filter(value => value.pId !== '0' && value.pId != null)
    let translator = (parents, children) => {
        parents.forEach((parent) => {
            children.forEach((current, index) => {
                if (current.pId === parent.id) {
                    let temp = JSON.parse(JSON.stringify(children))
                    temp.splice(index, 1)
                    translator([current], temp)
                    typeof parent.children !== 'undefined' ? parent.children.push(current) : parent.children = [current]
                }
            }
            )
        }
        )
    }
    translator(parents, children)
    return parents
}
```

### 11、类数组转换成数组操作

```javascript
/*	1.类数组可以使用for循环，但是不能使用数据方法，但是可以用call来使用例如：Array.prototype.join.call(arrLike,"&") 
	2.类数组转换成数组 */
		1. Array.prototype.slice.call(arrLike)     // 使用slice转化
		2. Array.prototype.splice.call(arrLike,0) 		
		3. Array.from(arrLike)  // 使用ES6的from方法
		4. Array.prototype.concat.Apply([],arrLike) // 把类数组传入一个空数组对象
	//3.Arguments就是一个类数组，Arguments的callee属性可以让函数调用自身
		example： 
			var data=[]
			for(var i=0;i<3;i++){
				(data[i]=function(){
					console.log(arguments.callee.i)
				}).i=i
					}
			data[0]() // 0
			data[1]() // 1
			data[2]() // 2
```

### 12、迭代

```javascript
// 会改变原数组
- pop
- push
- reverse,
- shift
- sort
- splice
- unshift
// 不会改变原数组
- map
- filter
- some
- every
- reduce
- forEach
// 不会改变原数组其他方法
- join
- concat
- indexOf
- lastIndexOf
- slice
- toString

// 几个注意点：
- 1 shift,pop会返回那个被删除的元素
- 2 splice 会返回被删除元素组成的数组，或者为空数组
- 3 push 会返回新数组长度
- 4 some 在有true的时候停止
- 5 every 在有false的时候停止
- 6 上述的迭代方法可以在最后追加一个参数thisArg,它是执行 callback 时的 this 值。
```

### 

## 8、字符串

### **1、去除空格**

- 

```javascript
const trim = function (str, type) {
  // 去除空格， type:  1-所有空格  2-前后空格  3-前空格 4-后空格
  type = type || 1;
  switch (type) {
    case 1:
      return str.replace(/\s+/g, "");
    case 2:
      return str.replace(/(^\s*)|(\s*$)/g, "");
    case 3:
      return str.replace(/(^\s*)/g, "");
    case 4:
      return str.replace(/(\s*$)/g, "");
    default:
      return str;
  }
};

```



### **2、字符串大小写转换**

- 

```javascript
const changeCase = function (str, type) {
  // 字符串大小写转换 type:  1:首字母大写  2：首页母小写  3：大小写转换  4：全部大写  5：全部小写
  type = type || 4;
  switch (type) {
    case 1:
      return str.replace(/\b\w+\b/g, function (word) {
        return (
          word.substring(0, 1).toUpperCase() + word.substring(1).toLowerCase()
        );
      });
    case 2:
      return str.replace(/\b\w+\b/g, function (word) {
        return (
          word.substring(0, 1).toLowerCase() + word.substring(1).toUpperCase()
        );
      });
    case 3:
      return str
        .split("")
        .map(function (word) {
          if (/[a-z]/.test(word)) {
            return word.toUpperCase();
          } else {
            return word.toLowerCase();
          }
        })
        .join("");
    case 4:
      return str.toUpperCase();
    case 5:
      return str.toLowerCase();
    default:
      return str;
  }
};

```

### **3、html过滤****代码**



```javascript
const filterTag = function (str) {
  // 过滤html代码(把<>转换)
  str = str.replace(/&/gi, "&");
  str = str.replace(/</gi, "<");
  str = str.replace(/>/gi, ">");
  str = str.replace(" ", " ");
  return str;
};

```

### 4、 获取十六进制随机颜色

```javascript
getRandomColor () {    
    return '#' + (function(h) {      
    return new Array(7 - h.length).join("0") + h;  
    })((Math.random() * 0x1000000 << 0).toString(16));}
```

### 5、三目运算的另一种写法

```
var docRole = userinfo.docRole == 0 && '医师' || '管理员';

var _src = userinfo.docPic ? userinfo.docPic : (userinfo.docSex == 2 ? 'images/women.png' : 'images/man.png');

记得以前看过别人写的文章里提到有网易的面试题出现过区分 ||  && 联合使用时返回的结果，当时老记不住，现在有这个应该容易记了
```

### 6、GUID

```javascript
newGuid() {
    //生成6-32位GUID
    var guid = "";
    var len = Math.floor(Math.random() * 22) + 6;
    for (var i = 1; i <= len; i++) {
      var n = Math.floor(Math.random() * 16.0).toString(16);
      guid += n;
      if (i == 4 || i == 10 || i == 15 || i == 19) guid += "-";
    }
    return guid;
  }
```

### 7、解析字符串对象

> 我们都知道，JavaScript对象可以序列化为JSON，JSON也可以解析成对象，但是问题是如果出现了一个既不是JSON也不是对象的"东西"，转成哪一方都不方便，那么eval就可以派上用场

```javascript
var obj = "{a:1,b:2}";   // 看起来像对象的字符串
eval("("+ obj +")")      // {a: 1, b: 2}
// 因为 eval 可以执行字符串表达式，我们希望将 obj 这个字符串对象 执行成真正的对象，那么就需要用eval。但是为了避免eval 将带 {} 的 obj 当语句来执行，我们就在obj的外面套了对 ()，让其被解析成表达式。
```

### 8、获取字符串中的字符数

```javascript
const characterCount = (str, char) => str.split(char).length - 1
```

### 9、生成随机字符串

```javascript
export const randomString = (len) => {
    let chars = 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz123456789';
    let strLen = chars.length;
    let randomStr = '';
    for (let i = 0; i < len; i++) {
        randomStr += chars.charAt(Math.floor(Math.random() * strLen));
    }
    return randomStr;
};
复制代码
```

### 10、手机号中间四位变成*

```javascript
export const telFormat = (tel) => {
  	tel = String(tel); 
    return tel.substr(0,3) + "****" + tel.substr(7);
};
复制代码
```

### 11、驼峰命名转换成短横线命名

```javascript
export const getKebabCase = (str) => {
    return str.replace(/[A-Z]/g, (item) => '-' + item.toLowerCase())
}
复制代码
```

### 12短横线命名转换成驼峰命名

```javascript
export const getCamelCase = (str) => {
    return str.replace( /-([a-z])/g, (i, item) => item.toUpperCase())
}
复制代码
```

### 13、全角转换为半角

```javascript
export const toCDB = (str) => {
  let result = "";
  for (let i = 0; i < str.length; i++) {
    code = str.charCodeAt(i);
    if (code >= 65281 && code <= 65374) {
      result += String.fromCharCode(str.charCodeAt(i) - 65248);
    } else if (code == 12288) {
      result += String.fromCharCode(str.charCodeAt(i) - 12288 + 32);
    } else {
      result += str.charAt(i);
    }
  }
  return result;
}

复制代码
```

### 14、半角转换为全角

```javascript
export const toDBC = (str) => {
  let result = "";
  for (let i = 0; i < str.length; i++) {
    code = str.charCodeAt(i);
    if (code >= 33 && code <= 126) {
      result += String.fromCharCode(str.charCodeAt(i) + 65248);
    } else if (code == 32) {
      result += String.fromCharCode(str.charCodeAt(i) + 12288 - 32);
    } else {
      result += str.charAt(i);
    }
  }
  return result;
}
```




## 9、数字

### **1、生成随机数范围**

- 

```javascript
const random = function (min, max) {
  // 生成随机数范围
  if (arguments.length === 2) {
    return Math.floor(min + Math.random() * (max + 1 - min));
  } else {
    return null;
  }
};
||
function randomBy(under, over){ 
   switch(arguments.length){ 
	 case 1: return parseInt(Math.random()*under+1); 
	 case 2: return parseInt(Math.random()*(over-under+1) + under); 
	 default: return 0; 
   } 
}

扩展：
1.取[10,100) 的随机整数方法

Math.floor(Math.random()*90+10);
或
randomBy(10, 100);


// 生成随机码（toString详解）

function randomNumber(count){
   return Math.random().toString(count).substring(2);
}
//count取值范围0-36

//randomNumber(10)
//"2584316588472575"

//randomNumber(14)
//"9b405070dd00122640c192caab84537"

//Math.random().toString(36).substring(2);
//"83vhdx10rmjkyb9"

```

### **2、阿拉伯数字转中文大写数字**



```javascript
const numberToChinese = function (num) {
  // 将阿拉伯数字翻译成中文的大写数字
  let AA = new Array(
    "零",
    "一",
    "二",
    "三",
    "四",
    "五",
    "六",
    "七",
    "八",
    "九",
    "十"
  );
  let BB = new Array("", "十", "百", "仟", "萬", "億", "点", "");
  let a = ("" + num).replace(/(^0*)/g, "").split(".");
  let k = 0;
  let re = "";
  for (let i = a[0].length - 1; i >= 0; i--) {
    switch (k) {
      case 0:
        re = BB[7] + re;
        break;
      case 4:
        if (!new RegExp("0{4}//d{" + (a[0].length - i - 1) + "}$").test(a[0])) {
          re = BB[4] + re;
        }
        break;
      case 8:
        re = BB[5] + re;
        BB[7] = BB[5];
        k = 0;
        break;
    }
    if (k % 4 === 2 && a[0].charAt(i + 2) !== 0 && a[0].charAt(i + 1) === 0) {
      re = AA[0] + re;
    }
    if (a[0].charAt(i) !== 0) {
      re = AA[a[0].charAt(i)] + BB[k % 4] + re;
    }
    k++;
  }
  if (a.length > 1) {
    // 加上小数部分(如果有小数部分)    re += BB[6]    for (let i = 0; i < a[1].length; i++) {      re += AA[a[1].charAt(i)]    }  }  if (re === '一十') {    re = '十'  }  if (re.match(/^一/) && re.length === 3) {
    re = re.replace("一", "");
  }
  return re;
};

```

### 3、 将数字转换为大写金额



```javascript
changeToChinese (Num) {        
    //判断如果传递进来的不是字符的话转换为字符        
    if(typeof Num == "number") {            
        Num = new String(Num);        
    };        
    Num = Num.replace(/,/g, "") 
    //替换tomoney()中的“,”        
    Num = Num.replace(/ /g, "") 
    //替换tomoney()中的空格        
    Num = Num.replace(/￥/g, "") 
    //替换掉可能出现的￥字符        
    if(isNaN(Num)) { 
        //验证输入的字符是否为数字            
        //alert("请检查小写金额是否正确");            
        return "";        
    };        
    //字符处理完毕后开始转换，采用前后两部分分别转换        
    var part = String(Num).split(".");        
    var newchar = "";        
    //小数点前进行转化        
    for(var i = part[0].length - 1; i >= 0; i--) {  
        if(part[0].length > 10) {  
            return "";                
            //若数量超过拾亿单位，提示           
        }           
        var tmpnewchar = ""           
        var perchar = part[0].charAt(i);            
        switch(perchar) {                
            case "0":                    
                tmpnewchar = "零" + tmpnewchar;                    
                break;                
            case "1":                    
                tmpnewchar = "壹" + tmpnewchar;                    
                break;                
            case "2":                   
                tmpnewchar = "贰" + tmpnewchar;                  
                break;                
            case "3":                   
                tmpnewchar = "叁" + tmpnewchar;                
                break;            
            case "4":                 
                tmpnewchar = "肆" + tmpnewchar;        
                break;               
            case "5":              
                tmpnewchar = "伍" + tmpnewchar;             
                break;            
            case "6":                 
                tmpnewchar = "陆" + tmpnewchar;        
                break;             
            case "7":                
                tmpnewchar = "柒" + tmpnewchar;    
                break;   
            case "8":        
                tmpnewchar = "捌" + tmpnewchar;         
                break;        
            case "9":              
                tmpnewchar = "玖" + tmpnewchar;         
                break;        
        }            
        switch(part[0].length - i - 1) {        
            case 0:              
                tmpnewchar = tmpnewchar + "元";        
                break;           
            case 1:               
                if(perchar != 0) tmpnewchar = tmpnewchar + "拾";    
                break;            
            case 2:              
                if(perchar != 0) tmpnewchar = tmpnewchar + "佰"; 
                break;       
            case 3:            
                if(perchar != 0) tmpnewchar = tmpnewchar + "仟";    
                break;               
            case 4:                
                tmpnewchar = tmpnewchar + "万";                 
                break;               
            case 5:                   
                if(perchar != 0) tmpnewchar = tmpnewchar + "拾";               
                break;            
            case 6:                   
                if(perchar != 0) tmpnewchar = tmpnewchar + "佰";                   
                break;               
            case 7:                    
                if(perchar != 0) tmpnewchar = tmpnewchar + "仟";              
                break;            
            case 8:                  
                tmpnewchar = tmpnewchar + "亿";                   
                break;               
            case 9:                  
                tmpnewchar = tmpnewchar + "拾";         
                break;          
        }       
        var newchar = tmpnewchar + newchar;       
    }          
    //小数点之后进行转化      
    if(Num.indexOf(".") != -1) {          
        if(part[1].length > 2) {       
            // alert("小数点之后只能保留两位,系统将自动截断");     
            part[1] = part[1].substr(0, 2)        
        }          
        for(i = 0; i < part[1].length; i++) {      
            tmpnewchar = ""              
            perchar = part[1].charAt(i)         
            switch(perchar) {      
                case "0":                   
                    tmpnewchar = "零" + tmpnewchar;     
                    break;          
                case "1":             
                    tmpnewchar = "壹" + tmpnewchar;    
                    break;              
                case "2":            
                    tmpnewchar = "贰" + tmpnewchar;    
                    break;              
                case "3":                 
                    tmpnewchar = "叁" + tmpnewchar;      
                    break;        
                case "4":                
                    tmpnewchar = "肆" + tmpnewchar;       
                    break;             
                case "5":            
                    tmpnewchar = "伍" + tmpnewchar;      
                    break;             
                case "6":                 
                    tmpnewchar = "陆" + tmpnewchar;       
                    break;      
                case "7":           
                    tmpnewchar = "柒" + tmpnewchar;      
                    break;              
                case "8":                 
                    tmpnewchar = "捌" + tmpnewchar;      
                    break;               
                case "9":                 
                    tmpnewchar = "玖" + tmpnewchar;      
                    break;               
            }               
            if(i == 0) tmpnewchar = tmpnewchar + "角";    
            if(i == 1) tmpnewchar = tmpnewchar + "分";     
            newchar = newchar + tmpnewchar;           
        }      
    }        
    //替换所有无用汉字      
    while(newchar.search("零零") != -1)      
        newchar = newchar.replace("零零", "零");  
        newchar = newchar.replace("零亿", "亿");   
        newchar = newchar.replace("亿万", "亿");      
        newchar = newchar.replace("零万", "万");       
    	newchar = newchar.replace("零元", "元");        
    	newchar = newchar.replace("零角", "");        
    	newchar = newchar.replace("零分", "");        
    	if(newchar.charAt(newchar.length - 1) == "元") {   
            newchar = newchar + "整"       
        }       
    return newchar;   
}
```

### 4、数字千分位分隔

```javascript
export const format = (n) => {
    let num = n.toString();
    let len = num.length;
    if (len <= 3) {
        return num;
    } else {
        let temp = '';
        let remainder = len % 3;
        if (remainder > 0) { // 不是3的整数倍
            return num.slice(0, remainder) + ',' + num.slice(remainder, len).match(/\d{3}/g).join(',') + temp;
        } else { // 3的整数倍
            return num.slice(0, len).match(/\d{3}/g).join(',') + temp; 
        }
    }
}
```



## 10、正则



### **1、常用正则验证**



```javascript
const checkStr = function (str, type) {
  // 常用正则验证，注意type大小写
  switch (type) {
    case "phone":
      // 手机号码
      return /^1[3|4|5|6|7|8|9][0-9]{9}$/.test(str);
    case "tel":
      // 座机
      return /^(0\d{2,3}-\d{7,8})(-\d{1,4})?$/.test(str);
    case "card":
      // 身份证
      return /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(str);
    case "pwd":
      // 密码以字母开头，长度在6~18之间，只能包含字母、数字和下划线
      return /^[a-zA-Z]\w{5,17}$/.test(str);
    case "postal":
      // 邮政编码
      return /[1-9]\d{5}(?!\d)/.test(str);
    case "QQ":
      // QQ号
      return /^[1-9][0-9]{4,9}$/.test(str);
    case "email":
      // 邮箱
      return /^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(str);
    case "money":
      // 金额(小数点2位)
      return /^\d*(?:\.\d{0,2})?$/.test(str);
    case "URL": // 网址
      return /(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/.test(
        str
      );
    case "IP": // IP
      return /((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))/.test(
        str
      );
    case "date": // 日期时间
      return (
        /^(\d{4})\-(\d{2})\-(\d{2}) (\d{2})(?:\:\d{2}|:(\d{2}):(\d{2}))$/.test(
          str
        ) || /^(\d{4})\-(\d{2})\-(\d{2})$/.test(str)
      );
    case "number": // 数字
      return /^[0-9]$/.test(str);
    case "english": // 英文
      return /^[a-zA-Z]+$/.test(str);
    case "chinese": // 中文
      return /^[\u4E00-\u9FA5]+$/.test(str);
    case "lower": // 小写
      return /^[a-z]+$/.test(str);
    case "upper": // 大写
      return /^[A-Z]+$/.test(str);
    case "HTML": // HTML标记
      return /<("[^"]*"|'[^']*'|[^'">])*>/.test(str);
    default:
      return true;
  }
};
//文件名可以带空格
 var reg = /^.*\.(?:xls|xlsx)$/i;
if (!reg.test(path)) {//校验不通过
	alert("请上传excel格式的文件!");
	return;
}

//正则表达式 数字和字母组合且必须含有一个

$pattern = '/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,10}$/';


/**
^ 匹配一行的开头位置
(?![0-9]+$) 预测该位置后面不全是数字
(?![a-zA-Z]+$) 预测该位置后面不全是字母
[0-9A-Za-z] {6,10} 由6-10位数字或这字母组成
$ 匹配行结尾位置
*/
```

### 2、 检测密码强度



```javascript
/*    检测密码强度*/
checkPwd (str) {    
    var Lv = 0;    
    if (str.length < 6) {        
        return Lv    
    }    
    if (/[0-9]/.test(str)) {        
        Lv++    
    }    
    if (/[a-z]/.test(str)) {        
        Lv++
    }    
    if (/[A-Z]/.test(str)) {       
        Lv++    
    }    
    if (/[\.|-|_]/.test(str)) {
        Lv++    
    }    
    return Lv;
}
```





## 11、数据类型

### 1、数据类型判断

```javascript
isString (o) { //是否字符串
    return Object.prototype.toString.call(o).slice(8, -1) === 'String'
}
isNumber (o) { //是否数字
    return Object.prototype.toString.call(o).slice(8, -1) === 'Number'
}

isObj (o) { //是否对象
    return Object.prototype.toString.call(o).slice(8, -1) === 'Object'
}

isArray (o) { //是否数组
    return Object.prototype.toString.call(o).slice(8, -1) === 'Array'
}

isDate (o) { //是否时间
    return Object.prototype.toString.call(o).slice(8, -1) === 'Date'
}

isBoolean (o) { //是否boolean
    return Object.prototype.toString.call(o).slice(8, -1) === 'Boolean'
}

isFunction (o) { //是否函数
    return Object.prototype.toString.call(o).slice(8, -1) === 'Function'
}

isNull (o) { //是否为null
    return Object.prototype.toString.call(o).slice(8, -1) === 'Null'
}

isUndefined (o) { //是否undefined
    return Object.prototype.toString.call(o).slice(8, -1) === 'Undefined'
}

isFalse (o) {
    if (!o || o === 'null' || o === 'undefined' || o === 'false' || o === 'NaN') return true
        return false
}

isTrue (o) {
    return !this.isFalse(o)
}
```

### 2、generator：

>generator（生成器）是ES6标准引入的新的数据类型。一个generator看上去像一个函数，但可以返回多次。

```javascript
	generator由function*定义（注意多出的*号），并且，除了return语句，还可以用yield返回多次。
			function* fib(max) {
			var
				t,
				a = 0,
				b = 1,
				n = 1;
			while (n < max) {
				yield a;
				t = a + b;
				a = b;
				b = t;
				n ++;
			}
			return a;
		}
			for (var x of fib(5)) {
			console.log(x); // 依次输出0, 1, 1, 2, 3
		}
```

### 

## 12、运算符

### 1、 & (按位与)

```javascript
//判断一个数是否为2的n次幂，可以将其与自身 减一相与
var number = 4
(number & number -1) === 0 // true
```

### 2、 ^ (按位异或)

```javascript
// 不用第三个变量，就可以交换两个变量的值
var a = 4,b = 3
a = a ^ b  //    7
b = a ^ b  //    4
a = a ^ b  //    3
```

### 3、 一元加

```javascript
// 一元加可以快速将字符串的数字转换为数学数字，即
var number = "23" 
typeof number  // string
typeof +number // number

// 可以将时间对象转为时间戳
new Date  //  Tue May 12 2015 22:21:33 GMT+0800 (CST)
+new Date //  1431440459887
```

### 

## 13、类

```javascript
/*检测类名*/
hasClass (ele, name) {   
    return ele.className.match(new RegExp('(\\s|^)' + name + '(\\s|$)'));
}
/*添加类名*/
addClass (ele, name) {   
        if (!this.hasClass(ele, name)) ele.className += " " + name;
}
/*删除类名*/
removeClass (ele, name) {   
    if (this.hasClass(ele, name)) {    
        var reg = new RegExp('(\\s|^)' + name + '(\\s|$)');    
        ele.className = ele.className.replace(reg, '');
    }}
/*替换类名*/
replaceClass (ele, newName, oldName) {  
    this.removeClass(ele, oldName);  
    this.addClass(ele, newName);
}
```

## 14、对象

### 1、 递归深拷贝

```javascript
function deepClone (sourceObj, targetObj) {
    let cloneObj = targetObj || {}
    if(!sourceObj || typeof sourceObj !== "object" || sourceObj.length === undefined){
        return sourceObj
    }
    if(sourceObj instanceof Array){
        cloneObj = sourceObj.concat()
    } else {
        for(let i in sourceObj){
            if (typeof sourceObj[i] === 'object') {
                cloneObj[i] = deepClone(sourceObj[i], {})
            } else {
                cloneObj[i] = sourceObj[i]
            }
        }
    }
    return cloneObj
}
```

### 2、**检查对象是否为空**

```
const isEmpty = obj => Reflect.ownKeys(obj).length === 0 && obj.constructor === Object
```

### 

## 15、函数方法

### **1、函数防抖**

- 

```javascript
const debounce = function (func, wait, immediate) {
  //函数防抖[func 函数,wait 延迟执行毫秒数,immediate true 表立即执行,false 表非立即执行,立即执行是触发事件后函数会立即执行，然后n秒内不触发事件才能继续执行函数的效果]
  let timeout;
  return function () {
    let context = this;
    let args = arguments;
    if (timeout) clearTimeout(timeout);
    if (immediate) {
      var callNow = !timeout;
      timeout = setTimeout(() => {
        timeout = null;
      }, wait);
      if (callNow) func.apply(context, args);
    } else {
      timeout = setTimeout(function () {
        func.apply(context, args);
      }, wait);
    }
  };
};

```



### **2、函数节流**



```javascript
const throttle = function (func, wait, type) {
  //函数节流 [func 函数 wait 延迟执行毫秒数 type 1 表时间戳版，2 表定时器版]
  if (type === 1) {
    let previous = 0;
  } else if (type === 2) {
    let timeout;
  }
  return function () {
    let context = this;
    let args = arguments;
    if (type === 1) {
      let now = Date.now();
      if (now - previous > wait) {
        func.apply(context, args);
        previous = now;
      }
    } else if (type === 2) {
      if (!timeout) {
        timeout = setTimeout(() => {
          timeout = null;
          func.apply(context, args);
        }, wait);
      }
    }
  };
};
```





## 16、前端工程化

### 1、引入文件

> ###### vue项目中 使用require.context()实现前端工程化引入文件

```javascript
require.context(directory, useSubdirectories, regExp, mode = 'sync')
// directory:表示检索的目录
// useSubdirectories：表示是否检索子文件夹
// regExp:匹配文件的正则表达式,一般是文件名
// mode:加载模式，同步/异步
```

> ###### 用来在组件内引入多个组件

```javascript
// 从@/components/home目录下加载所有.vue后缀的组件
const files = require.context('@/components/home', false, /\.vue$/);
const components = {};
 
// 遍历files对象，构建components键值
files.keys().forEach(key => {
    components[key.replace(/(\.\/|\.vue)/g, '')] = files(key).default
});
 
export default {
    ...
 
    components, // ES6语法糖，代表 components: components,
 
    ...
}

```

> ###### 在main.js中引入大量公共组件

```javascript
import Vue from 'vue'
// 自定义组件
const requireComponents = require.context('../views/components', true, /\.vue/)
// 打印结果
// 遍历出每个组件的路径
requireComponents.keys().forEach(fileName => {
  // 组件实例
  const reqCom = requireComponents(fileName)
  // 截取路径作为组件名
  const reqComName =reqCom.name|| fileName.replace(/\.\/(.*)\.vue/,'$1')
  // 组件挂载
  Vue.component(reqComName, reqCom.default || reqCom)
})

```

> 用在vuex中加载module 或加载多个api接口

```javascript
/**
 * The file enables `@/store/index.js` to import all vuex modules
 * in a one-shot manner. There should not be any reason to edit this file.
 */
 
const files = require.context('.', false, /\.js$/)
const modules = {}
 
files.keys().forEach(key => {
  if (key === './index.js') return
  modules[key.replace(/(\.\/|\.js)/g, '')] = files(key).default
})
 
export default modules

```



## 17、 css

```css
/* normalize.css */
html { 
    line-height: 1.15;  /* 1 */  
    -ms-text-size-adjust: 100%;  /* 2 */ 
    -webkit-text-size-adjust: 100%;  /* 2 */
}body {
    margin: 0;
}
article,aside,footer,header,nav,section {
    display: block;
}
h1 { 
    font-size: 2em;  margin: 0.67em 0;
}
figcaption,figure,main { 
    /* 1 */
    display: block;
}
figure {
    margin: 1em 40px;
}
hr { 
    box-sizing: content-box;  /* 1 */ 
    height: 0;  /* 1 */ 
    overflow: visible;  /* 2 */
}
pre { 
    font-family: monospace, monospace;  /* 1 */  
    font-size: 1em;  /* 2 */
}
a {  
    background-color: transparent;  /* 1 */ 
    -webkit-text-decoration-skip: objects;  /* 2 */
}
abbr[title] { 
    border-bottom: none;  /* 1 */  
    text-decoration: underline;  /* 2 */  
    text-decoration: underline dotted;  /* 2 */
}
b,strong {  
    font-weight: inherit;
}
b,strong { 
    font-weight: bolder;
}
code,kbd,samp {  
    font-family: monospace, monospace;  /* 1 */  font-size: 1em;  /* 2 */}
dfn {  
    font-style: italic;
}mark { 
    background-color: #ff0;  color: #000;
}small { 
    font-size: 80%;}sub,sup {  font-size: 75%;  line-height: 0;  position: relative;  vertical-align: baseline;}sub {  bottom: -0.25em;}sup {  top: -0.5em;}audio,video {  display: inline-block;}audio:not([controls]) {  display: none;  height: 0;}img {  border-style: none;}svg:not(:root) {  overflow: hidden;}button,input,optgroup,select,textarea {  font-family: sans-serif;  /* 1 */  font-size: 100%;  /* 1 */  line-height: 1.15;  /* 1 */  margin: 0;  /* 2 */}button,input {  /* 1 */  overflow: visible;}button,select {  /* 1 */  text-transform: none;}button,html [type="button"],/* 1 */[type="reset"],[type="submit"] {  -webkit-appearance: button;  /* 2 */}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner {  border-style: none;  padding: 0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring {  outline: 1px dotted ButtonText;}fieldset {  padding: 0.35em 0.75em 0.625em;}legend {  box-sizing: border-box;  /* 1 */  color: inherit;  /* 2 */  display: table;  /* 1 */  max-width: 100%;  /* 1 */  padding: 0;  /* 3 */  white-space: normal;  /* 1 */}progress {  display: inline-block;  /* 1 */  vertical-align: baseline;  /* 2 */}textarea {  overflow: auto;}[type="checkbox"],[type="radio"] {  box-sizing: border-box;  /* 1 */  padding: 0;  /* 2 */}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button {  height: auto;}[type="search"] {  -webkit-appearance: textfield;  /* 1 */  outline-offset: -2px;  /* 2 */}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration {  -webkit-appearance: none;} ::-webkit-file-upload-button {  -webkit-appearance: button;  /* 1 */  font: inherit;  /* 2 */}details,/* 1 */menu {  display: block;}summary {  display: list-item;}canvas {  display: inline-block;}template {  display: none;}[hidden] {  display: none;}/* reset */html,body,h1,h2,h3,h4,h5,h6,div,dl,dt,dd,ul,ol,li,p,blockquote,pre,hr,figure,table,caption,th,td,form,fieldset,legend,input,button,textarea,menu {  margin: 0;  padding: 0;  box-sizing: border-box;}

/*	Phone-reset*/* normalize.css */

html { 
    line-height: 1.15;  /* 1 */  -ms-text-size-adjust: 100%;  /* 2 */  -webkit-text-size-adjust: 100%;  /* 2 */}body {  margin: 0;}article,aside,footer,header,nav,section {  display: block;}h1 {  font-size: 2em;  margin: 0.67em 0;}figcaption,figure,main {  /* 1 */  display: block;}figure {  margin: 1em 40px;}hr {  box-sizing: content-box;  /* 1 */  height: 0;  /* 1 */  overflow: visible;  /* 2 */}pre {  font-family: monospace, monospace;  /* 1 */  font-size: 1em;  /* 2 */}a {  background-color: transparent;  /* 1 */  -webkit-text-decoration-skip: objects;  /* 2 */}abbr[title] {  border-bottom: none;  /* 1 */  text-decoration: underline;  /* 2 */  text-decoration: underline dotted;  /* 2 */}b,strong {  font-weight: inherit;}b,strong {  font-weight: bolder;}code,kbd,samp {  font-family: monospace, monospace;  /* 1 */  font-size: 1em;  /* 2 */}dfn {  font-style: italic;}mark {  background-color: #ff0;  color: #000;}small {  font-size: 80%;}sub,sup {  font-size: 75%;  line-height: 0;  position: relative;  vertical-align: baseline;}sub {  bottom: -0.25em;}sup {  top: -0.5em;}audio,video {  display: inline-block;}audio:not([controls]) {  display: none;  height: 0;}img {  border-style: none;}svg:not(:root) {  overflow: hidden;}button,input,optgroup,select,textarea {  font-family: sans-serif;  /* 1 */  font-size: 100%;  /* 1 */  line-height: 1.15;  /* 1 */  margin: 0;  /* 2 */}button,input {  /* 1 */  overflow: visible;}button,select {  /* 1 */  text-transform: none;}button,html [type="button"],/* 1 */[type="reset"],[type="submit"] {  -webkit-appearance: button;  /* 2 */}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner {  border-style: none;  padding: 0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring {  outline: 1px dotted ButtonText;}fieldset {  padding: 0.35em 0.75em 0.625em;}legend {  box-sizing: border-box;  /* 1 */  color: inherit;  /* 2 */  display: table;  /* 1 */  max-width: 100%;  /* 1 */  padding: 0;  /* 3 */  white-space: normal;  /* 1 */}progress {  display: inline-block;  /* 1 */  vertical-align: baseline;  /* 2 */}textarea {  overflow: auto;}[type="checkbox"],[type="radio"] {  box-sizing: border-box;  /* 1 */  padding: 0;  /* 2 */}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button {  height: auto;}[type="search"] {  -webkit-appearance: textfield;  /* 1 */  outline-offset: -2px;  /* 2 */}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration {  -webkit-appearance: none;} ::-webkit-file-upload-button {  -webkit-appearance: button;  /* 1 */  font: inherit;  /* 2 */}details,/* 1 */menu {  display: block;}summary {  display: list-item;}canvas {  display: inline-block;}template {  display: none;}[hidden] {  display: none;}

/* reset */
html,body { 
    /* 禁止选中文本 */  
    -webkit-user-select: none;
    user-select: none;  
    font: Oswald, 'Open Sans', 
        Helvetica, Arial, sans-serif
}
/* 禁止长按链接与图片弹出菜单 */
a,img {  
    -webkit-touch-callout: none;
}
/*ios android去除自带阴影的样式*/
a,input { 
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
input[type="text"] { 
        -webkit-appearance: none;
}
/*	公共样式提取*//* 禁止选中文本 */
.usn{   
    
    -webkit-user-select:none;  
    -moz-user-select:none; 
    -ms-user-select:none;  
    -o-user-select:none;   
    user-select:none;}
/* 浮动 */
.fl {
    float: left;
}
.fr {
    float: right; 
}.cf { zoom: 1; }.cf:after {    content:".";    display:block;    clear:both;    visibility:hidden;    height:0;    overflow:hidden;}

/* 元素类型 */
.db { display: block; }.dn { display: none; }.di { display: inline }.dib {display: inline-block;}.transparent { opacity: 0 }

/*文字排版、颜色*/
.f12 { font-size:12px }.f14 { font-size:14px }.f16 { font-size:16px }.f18 { font-size:18px }.f20 { font-size:20px }.fb { font-weight:bold }.fn { font-weight:normal }.t2 { text-indent:2em }.red,a.red { color:#cc0031 }.darkblue,a.darkblue { color:#039 }.gray,a.gray { color:#878787 }.lh150 { line-height:150% }.lh180 { line-height:180% }.lh200 { line-height:200% }.unl { text-decoration:underline; }.no_unl { text-decoration:none; }.tl { text-align: left; }.tc { text-align: center; }.tr { text-align: right; }.tj { text-align: justify; text-justify: inter-ideograph; }.wn { /* 强制不换行 */    word-wrap:normal;    white-space:nowrap;}
.wb {
    /* 强制换行 */  
    white-space:normal;  
    word-wrap:break-word;   
    word-break:break-all;
}
.wp { 
    /* 保持空白序列*/  
    overflow:hidden;
    text-align:left;
    white-space:pre-wrap;
    word-wrap:break-word;
    word-break:break-all;
}
.wes {
    /* 多出部分用省略号表示 , 用于一行 */   
    overflow:hidden; 
    word-wrap:normal;    
    white-space:nowrap;    
    text-overflow:ellipsis;
}
.wes-2 {
    /* 适用于webkit内核和移动端 */   
        display: -webkit-box;  
        -webkit-box-orient: vertical;  
        -webkit-line-clamp: 2;  
        overflow: hidden;} 
.wes-3 {  
     display: -webkit-box;   
    -webkit-box-orient: vertical;  
    -webkit-line-clamp: 3;  
    overflow: hidden;
}
.wes-4 {    
    display: -webkit-box;   
    -webkit-box-orient: vertical;   
    -webkit-line-clamp: 4;  
    overflow: hidden;
}

/* 溢出样式 */
.ofh 
{ 
    overflow: hidden; 
}
.ofs {overflow: scroll; }.ofa {overflow: auto; }.ofv {overflow: visible; }
/* 定位方式 */
.ps {position: static; }.pr {position: relative;zoom:1; }.pa {position: absolute; }.pf {position: fixed; }/* 垂直对齐方式 */.vt {vertical-align: top; }.vm {vertical-align: middle; }.vb {vertical-align: bottom; }/* 鼠标样式 */.csd {cursor: default; }.csp {cursor: pointer; }.csh {cursor: help; }.csm {cursor: move; }/* flex布局 */.df-sb {    display:flex;    align-items: center;    justify-content: space-between;}.df-sa {    display:flex;    align-items: center;    justify-content: space-around;}/* 垂直居中 */.df-c {    display: flex;    align-items: center;    justify-content: center;}.tb-c {    text-align:center;    display:table-cell;    vertical-align:middle;}.ts-c {    position: absolute;    left: 50%; top: 50%;    transform: translate(-50%, -50%);}.ts-mc {    position: absolute;    left: 0;right: 0;    bottom: 0; top: 0;    margin: auto;}/* 辅助 */.mask-fixed-wrapper {    width: 100%;    height: 100%;    position: fixed;    left:0;top:0;    background: rgba(0, 0, 0, 0.65);    z-index: 999;}.bg-cover {    background-size: cover;    background-repeat: no-repeat;    background-position: center center;}.bg-cover-all {    background-size: 100% 100%;    background-repeat: no-repeat;    background-position: center center;}
```





